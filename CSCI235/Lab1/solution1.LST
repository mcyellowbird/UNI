SQL> set echo on;
SQL> set feedback on;
SQL> set linesize 100;
SQL> set pagesize 200;
SQL> 
SQL> ALTER TABLE EMPLOYEE
  2  ADD TOTAL_ORDERS NUMBER(5) DEFAULT(NULL);

Table EMPLOYEE altered.

SQL> 
SQL> UPDATE EMPLOYEE
  2  SET TOTAL_ORDERS =
  3  (SELECT COUNT(EMPLOYEE_ID)
  4  FROM ORDERS 
  5  WHERE EMPLOYEE.EMPLOYEE_ID = ORDERS.EMPLOYEE_ID);

9 rows updated.

SQL> 
SQL> UPDATE EMPLOYEE
  2  SET TOTAL_ORDERS = 0
  3  WHERE TOTAL_ORDERS = NULL;

0 rows updated.

SQL> 
SQL> ALTER TABLE EMPLOYEE
  2  ADD CONSTRAINT CHK_TOTAL CHECK (TOTAL_ORDERS IS NOT NULL);

Table EMPLOYEE altered.

SQL> 
SQL> CREATE TABLE CUSTOMER_COUNTRIES AS
  2      SELECT COUNTRY, COUNT(CUSTOMER_CODE) AS CUSTOMERS
  3      FROM CUSTOMER
  4      GROUP BY COUNTRY;

Table CUSTOMER_COUNTRIES created.

SQL> 
SQL> ALTER TABLE CUSTOMER_COUNTRIES
  2  ADD CONSTRAINT PK_COUNTRY PRIMARY KEY (COUNTRY);

Table CUSTOMER_COUNTRIES altered.

SQL> 
SQL> ALTER TABLE CUSTOMER_COUNTRIES
  2  ADD CONSTRAINT CHK_CUSTOMERS CHECK (CUSTOMERS IS NOT NULL);

Table CUSTOMER_COUNTRIES altered.

SQL> 
SQL> spool off;
